{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <div class="card shadow-lg p-4">
        <h1 class="text-primary mb-1">Record Your Best Ideas and Questions!</h1>
        <h2 class="text-secondary" style="font-size: 1.25rem; margin-top: -0.5rem;">Turn your thoughts into words.</h2>
        <br>


        <span class="text-center mt-4" id="subtitle-options">Please select the idea that best aligns with what you intended to explain; the chosen option will be sent to the chat for a response, or the feature will regenerate options based on your selection.</span>
        <div id="results-container" class="mt-4">
            <form id="form" action="/reload_answer" method="POST">
                {% for answer in answers %}
                    <label>
                        <input type="radio" name="answer" value="{{answer}}" id="answer-{{ loop.index }}">
                        {{ answer }}
                    </label>
                    <br>
                {% endfor %}
                <button type="submit" class="btn btn-primary mt-3">Regeneate Ideas</button>
            </form>
        </div>
        

        <div class="text-center mt-4">
            <a id="send-to-chat-btn" href="#" class="btn btn-primary btn-lg shadow">Send your idea/question to Chat</a>
        </div>

        <div id="new-idea-div" class="text-center mt-4">
            <button id="new-idea-button" class="btn btn-secondary btn-lg shadow">Start a New Idea</button>
        </div>
    </div>

    <!-- Spinner -->
    <br><br><br>
    <div id="loading-spinner"></div>
</div>

<style>
    
    /* Spinner styles */
    #loading-spinner {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 1000;
        width: 50px;
        height: 50px;
        border: 5px solid #f3f3f3;
        border-top: 5px solid #007bff; /* Match link color */
        border-radius: 50%;
        animation: spin 1s linear infinite;
        display: none;
    }


    @keyframes spin {
        from {
            transform: rotate(0deg);
        }
        to {
            transform: rotate(360deg);
        }
    }
</style>


<script>
    document.getElementById("new-idea-button").addEventListener("click", () => {
        window.location.href = "/dysgraphia";
    });

    document.getElementById('send-to-chat-btn').addEventListener('click', function(event) {
        event.preventDefault();

        const selectedOption = document.querySelector('input[name="answer"]:checked');

        if (selectedOption) {
            const questionValue = selectedOption.value;
            const url = `{{ url_for('dysgraphia.send_to_chat') }}?question=${encodeURIComponent(questionValue)}`;

            this.setAttribute('href', url);

            window.location.href = url;
        } else {
            // alert('Please select an option before sending to chat.');
        }
    });
</script>

</html>

{% endblock %}
